[dotenv@17.2.1] injecting env (11) from .env.test -- tip: ΓÜÖ∩╕Å  load multiple .env files with { path: ['.env.local', '.env'] }
Table TestAssignments already exists.
Table TestPolicies already exists.
Table TestPermissions already exists.
Table TestRoles already exists.
Table TestUsers already exists.
FAIL tests/integration/Persistence/DynamoUserProfileRepository.integration.spec.ts (11.1 s)
  ΓùÅ DynamoUserProfileRepository Integration Tests ΓÇ║ should save a new user profile

    ResourceNotFoundException: Requested resource not found

      at de_ResourceNotFoundExceptionRes (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2612:21)
      at de_CommandError (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2269:19)
      at node_modules/.pnpm/@smithy+middleware-serde@4.0.9/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20
      at node_modules/.pnpm/@aws-sdk+lib-dynamodb@3.879_ee4568148364d683af0669b014af13ba/node_modules/@aws-sdk/lib-dynamodb/dist-cjs/index.js:173:30
      at node_modules/.pnpm/@smithy+core@3.9.0/node_modules/@smithy/core/dist-cjs/index.js:193:18
      at node_modules/.pnpm/@smithy+middleware-retry@4.1.20/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38
      at node_modules/.pnpm/@aws-sdk+middleware-logger@3.876.0/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22

  ΓùÅ DynamoUserProfileRepository Integration Tests ΓÇ║ should throw error when saving duplicate user profile (implement check in repo)

    ResourceNotFoundException: Requested resource not found

      at de_ResourceNotFoundExceptionRes (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2612:21)
      at de_CommandError (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2269:19)
      at node_modules/.pnpm/@smithy+middleware-serde@4.0.9/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20
      at node_modules/.pnpm/@aws-sdk+lib-dynamodb@3.879_ee4568148364d683af0669b014af13ba/node_modules/@aws-sdk/lib-dynamodb/dist-cjs/index.js:173:30
      at node_modules/.pnpm/@smithy+core@3.9.0/node_modules/@smithy/core/dist-cjs/index.js:193:18
      at node_modules/.pnpm/@smithy+middleware-retry@4.1.20/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38
      at node_modules/.pnpm/@aws-sdk+middleware-logger@3.876.0/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22

  ΓùÅ DynamoUserProfileRepository Integration Tests ΓÇ║ should find an existing profile by ID

    ResourceNotFoundException: Requested resource not found

      at de_ResourceNotFoundExceptionRes (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2612:21)
      at de_CommandError (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2269:19)
      at node_modules/.pnpm/@smithy+middleware-serde@4.0.9/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20
      at node_modules/.pnpm/@aws-sdk+lib-dynamodb@3.879_ee4568148364d683af0669b014af13ba/node_modules/@aws-sdk/lib-dynamodb/dist-cjs/index.js:173:30
      at node_modules/.pnpm/@smithy+core@3.9.0/node_modules/@smithy/core/dist-cjs/index.js:193:18
      at node_modules/.pnpm/@smithy+middleware-retry@4.1.20/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38
      at node_modules/.pnpm/@aws-sdk+middleware-logger@3.876.0/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22

  ΓùÅ DynamoUserProfileRepository Integration Tests ΓÇ║ should return null when finding non-existent profile by ID

    ResourceNotFoundException: Requested resource not found

      at de_ResourceNotFoundExceptionRes (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2612:21)
      at de_CommandError (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2269:19)
      at node_modules/.pnpm/@smithy+middleware-serde@4.0.9/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20
      at node_modules/.pnpm/@aws-sdk+lib-dynamodb@3.879_ee4568148364d683af0669b014af13ba/node_modules/@aws-sdk/lib-dynamodb/dist-cjs/index.js:173:30
      at node_modules/.pnpm/@smithy+core@3.9.0/node_modules/@smithy/core/dist-cjs/index.js:193:18
      at node_modules/.pnpm/@smithy+middleware-retry@4.1.20/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38
      at node_modules/.pnpm/@aws-sdk+middleware-logger@3.876.0/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22

  ΓùÅ DynamoUserProfileRepository Integration Tests ΓÇ║ should find an existing profile by Email (assuming index exists)

    ResourceNotFoundException: Requested resource not found

      at de_ResourceNotFoundExceptionRes (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2612:21)
      at de_CommandError (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2269:19)
      at node_modules/.pnpm/@smithy+middleware-serde@4.0.9/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20
      at node_modules/.pnpm/@aws-sdk+lib-dynamodb@3.879_ee4568148364d683af0669b014af13ba/node_modules/@aws-sdk/lib-dynamodb/dist-cjs/index.js:173:30
      at node_modules/.pnpm/@smithy+core@3.9.0/node_modules/@smithy/core/dist-cjs/index.js:193:18
      at node_modules/.pnpm/@smithy+middleware-retry@4.1.20/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38
      at node_modules/.pnpm/@aws-sdk+middleware-logger@3.876.0/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22

  ΓùÅ DynamoUserProfileRepository Integration Tests ΓÇ║ should return null when finding non-existent profile by Email

    ResourceNotFoundException: Requested resource not found

      at de_ResourceNotFoundExceptionRes (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2612:21)
      at de_CommandError (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2269:19)
      at node_modules/.pnpm/@smithy+middleware-serde@4.0.9/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20
      at node_modules/.pnpm/@aws-sdk+lib-dynamodb@3.879_ee4568148364d683af0669b014af13ba/node_modules/@aws-sdk/lib-dynamodb/dist-cjs/index.js:173:30
      at node_modules/.pnpm/@smithy+core@3.9.0/node_modules/@smithy/core/dist-cjs/index.js:193:18
      at node_modules/.pnpm/@smithy+middleware-retry@4.1.20/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38
      at node_modules/.pnpm/@aws-sdk+middleware-logger@3.876.0/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22

  ΓùÅ DynamoUserProfileRepository Integration Tests ΓÇ║ should update an existing profile

    ResourceNotFoundException: Requested resource not found

      at de_ResourceNotFoundExceptionRes (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2612:21)
      at de_CommandError (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2269:19)
      at node_modules/.pnpm/@smithy+middleware-serde@4.0.9/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20
      at node_modules/.pnpm/@aws-sdk+lib-dynamodb@3.879_ee4568148364d683af0669b014af13ba/node_modules/@aws-sdk/lib-dynamodb/dist-cjs/index.js:173:30
      at node_modules/.pnpm/@smithy+core@3.9.0/node_modules/@smithy/core/dist-cjs/index.js:193:18
      at node_modules/.pnpm/@smithy+middleware-retry@4.1.20/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38
      at node_modules/.pnpm/@aws-sdk+middleware-logger@3.876.0/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22

  ΓùÅ DynamoUserProfileRepository Integration Tests ΓÇ║ should throw error when updating non-existent profile (implement check)

    ResourceNotFoundException: Requested resource not found

      at de_ResourceNotFoundExceptionRes (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2612:21)
      at de_CommandError (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2269:19)
      at node_modules/.pnpm/@smithy+middleware-serde@4.0.9/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20
      at node_modules/.pnpm/@aws-sdk+lib-dynamodb@3.879_ee4568148364d683af0669b014af13ba/node_modules/@aws-sdk/lib-dynamodb/dist-cjs/index.js:173:30
      at node_modules/.pnpm/@smithy+core@3.9.0/node_modules/@smithy/core/dist-cjs/index.js:193:18
      at node_modules/.pnpm/@smithy+middleware-retry@4.1.20/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38
      at node_modules/.pnpm/@aws-sdk+middleware-logger@3.876.0/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22

  ΓùÅ DynamoUserProfileRepository Integration Tests ΓÇ║ should delete an existing profile

    ResourceNotFoundException: Requested resource not found

      at de_ResourceNotFoundExceptionRes (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2612:21)
      at de_CommandError (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2269:19)
      at node_modules/.pnpm/@smithy+middleware-serde@4.0.9/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20
      at node_modules/.pnpm/@aws-sdk+lib-dynamodb@3.879_ee4568148364d683af0669b014af13ba/node_modules/@aws-sdk/lib-dynamodb/dist-cjs/index.js:173:30
      at node_modules/.pnpm/@smithy+core@3.9.0/node_modules/@smithy/core/dist-cjs/index.js:193:18
      at node_modules/.pnpm/@smithy+middleware-retry@4.1.20/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38
      at node_modules/.pnpm/@aws-sdk+middleware-logger@3.876.0/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22

  ΓùÅ DynamoUserProfileRepository Integration Tests ΓÇ║ should not throw when deleting non-existent profile (idempotent)

    ResourceNotFoundException: Requested resource not found

      at de_ResourceNotFoundExceptionRes (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2612:21)
      at de_CommandError (node_modules/.pnpm/@aws-sdk+client-dynamodb@3.879.0/node_modules/@aws-sdk/client-dynamodb/dist-cjs/index.js:2269:19)
      at node_modules/.pnpm/@smithy+middleware-serde@4.0.9/node_modules/@smithy/middleware-serde/dist-cjs/index.js:36:20
      at node_modules/.pnpm/@aws-sdk+lib-dynamodb@3.879_ee4568148364d683af0669b014af13ba/node_modules/@aws-sdk/lib-dynamodb/dist-cjs/index.js:173:30
      at node_modules/.pnpm/@smithy+core@3.9.0/node_modules/@smithy/core/dist-cjs/index.js:193:18
      at node_modules/.pnpm/@smithy+middleware-retry@4.1.20/node_modules/@smithy/middleware-retry/dist-cjs/index.js:320:38
      at node_modules/.pnpm/@aws-sdk+middleware-logger@3.876.0/node_modules/@aws-sdk/middleware-logger/dist-cjs/index.js:33:22

FAIL tests/e2e/user.admin.e2e.spec.ts (15.444 s)
  ΓùÅ Console

    console.log
      Response Status: 400

      at tests/e2e/user.admin.e2e.spec.ts:50:21

    console.log
      Response Body: {
        status: 'error',
        name: 'ValidationError',
        message: 'Input validation failed',
        requestId: '6f312d36-beee-4a4b-8ade-800882dcfad7',
        details: { username: 'Username is required', userAttributes: 'Required' }
      }

      at tests/e2e/user.admin.e2e.spec.ts:51:21

  ΓùÅ User Admin E2E ΓÇ║ should create a new user

    expect(received).toBe(expected) // Object.is equality

    Expected: 201
    Received: 400

      51 |             console.log('Response Body:', response.body);
      52 |         }
    > 53 |         expect(response.status).toBe(201); // Added explicit status check
         |                                 ^
      54 |         expect(response.body.username).toBe(username);
      55 |         expect(userMgmtAdapterMock.adminCreateUser).toHaveBeenCalledWith(userDetails);
      56 |     });

      at tests/e2e/user.admin.e2e.spec.ts:53:33
      at fulfilled (tests/e2e/user.admin.e2e.spec.ts:5:58)

  ΓùÅ User Admin E2E ΓÇ║ should update the user attributes

    expected 204 "No Content", got 404 "Not Found"

      81 |             .set('Authorization', `Bearer ${adminToken}`)
      82 |             .send(attributesToUpdate)
    > 83 |             .expect(204);
         |              ^
      84 |         
      85 |         expect(userMgmtAdapterMock.adminUpdateUserAttributes).toHaveBeenCalledWith({ username, ...attributesToUpdate });
      86 |     });

      at tests/e2e/user.admin.e2e.spec.ts:83:14
      at tests/e2e/user.admin.e2e.spec.ts:8:71
      at Object.<anonymous>.__awaiter (tests/e2e/user.admin.e2e.spec.ts:4:12)
      at Object.<anonymous> (tests/e2e/user.admin.e2e.spec.ts:71:56)
      ----
      at Test._assertStatus (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:309:14)
      at node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:365:13
      at Test._assertFunction (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:342:13)
      at Test.assert (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:195:23)
      at localAssert (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:138:14)
      at Server.<anonymous> (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:152:11)

  ΓùÅ User Admin E2E ΓÇ║ should add a user to a group

    expected 204 "No Content", got 200 "OK"

       96 |             .set('Authorization', `Bearer ${adminToken}`)
       97 |             .send({ groupName })
    >  98 |             .expect(204);
          |              ^
       99 |         
      100 |         expect(userMgmtAdapterMock.adminAddUserToGroup).toHaveBeenCalledWith(username, groupName);
      101 |     });

      at tests/e2e/user.admin.e2e.spec.ts:98:14
      at tests/e2e/user.admin.e2e.spec.ts:8:71
      at Object.<anonymous>.__awaiter (tests/e2e/user.admin.e2e.spec.ts:4:12)
      at Object.<anonymous> (tests/e2e/user.admin.e2e.spec.ts:91:51)
      ----
      at Test._assertStatus (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:309:14)
      at node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:365:13
      at Test._assertFunction (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:342:13)
      at Test.assert (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:195:23)
      at localAssert (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:138:14)
      at Server.<anonymous> (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:152:11)

  ΓùÅ User Admin E2E ΓÇ║ should disable the user

    expected 204 "No Content", got 404 "Not Found"

      131 |             .post(`${BASE_API_PATH}/${username}/disable`)
      132 |             .set('Authorization', `Bearer ${adminToken}`)
    > 133 |             .expect(204);
          |              ^
      134 |         
      135 |         expect(userMgmtAdapterMock.adminDisableUser).toHaveBeenCalledWith(username);
      136 |     });

      at tests/e2e/user.admin.e2e.spec.ts:133:14
      at tests/e2e/user.admin.e2e.spec.ts:8:71
      at Object.<anonymous>.__awaiter (tests/e2e/user.admin.e2e.spec.ts:4:12)
      at Object.<anonymous> (tests/e2e/user.admin.e2e.spec.ts:127:46)
      ----
      at Test._assertStatus (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:309:14)
      at node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:365:13
      at Test._assertFunction (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:342:13)
      at Test.assert (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:195:23)
      at localAssert (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:138:14)
      at Server.<anonymous> (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:152:11)

  ΓùÅ User Admin E2E ΓÇ║ should enable the user

    expected 204 "No Content", got 404 "Not Found"

      142 |             .post(`${BASE_API_PATH}/${username}/enable`)
      143 |             .set('Authorization', `Bearer ${adminToken}`)
    > 144 |             .expect(204);
          |              ^
      145 |         
      146 |         expect(userMgmtAdapterMock.adminEnableUser).toHaveBeenCalledWith(username);
      147 |     });

      at tests/e2e/user.admin.e2e.spec.ts:144:14
      at tests/e2e/user.admin.e2e.spec.ts:8:71
      at Object.<anonymous>.__awaiter (tests/e2e/user.admin.e2e.spec.ts:4:12)
      at Object.<anonymous> (tests/e2e/user.admin.e2e.spec.ts:138:45)
      ----
      at Test._assertStatus (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:309:14)
      at node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:365:13
      at Test._assertFunction (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:342:13)
      at Test.assert (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:195:23)
      at localAssert (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:138:14)
      at Server.<anonymous> (node_modules/.pnpm/supertest@7.1.4/node_modules/supertest/lib/test.js:152:11)

PASS tests/integration/Adapter/CognitoUserMgmtAdapter.integration.spec.ts (17.916 s)
  ΓùÅ Console

    console.info
      [ConfigService] Reading configuration from process.env (expected to be populated by --env-file)

      at new EnvironmentConfigService (src/infrastructure/config/EnvironmentConfigService.ts:36:17)
          at Array.map (<anonymous>)

    console.debug
      [ConfigService] Configuration loaded (keys only): [
        'ALLUSERSPROFILE',
        'ANDROID_HOME',
        'ANTIGRAVITY_AGENT',
        'ANTIGRAVITY_CLI_ALIAS',
        'APPDATA',
        'AWS_ACCESS_KEY_ID',
        'AWS_REGION',
        'AWS_SECRET_ACCESS_KEY',
        'ChocolateyInstall',
        'ChocolateyLastPathUpdate',
        'CHROME_CRASHPAD_PIPE_NAME',
        'CLASSPATH',
        'COGNITO_CLIENT_ID',
        'COGNITO_ISSUER',
        'COGNITO_JWKS_URI',
        'COGNITO_USER_POOL_ID',
        'COLOR',
        'COLORTERM',
        'CommonProgramFiles',
        'CommonProgramFiles(x86)',
        'CommonProgramW6432',
        'COMPUTERNAME',
        'ComSpec',
        'DriverData',
        'EDITOR',
        'GIT_ASKPASS',
        'GRADLE_HOME',
        'HOME',
        'HOMEDRIVE',
        'HOMEPATH',
        'INIT_CWD',
        'INTEL_DEV_REDIST',
        'JAVA_HOME',
        'JEST_WORKER_ID',
        'LANG',
        'LOCALAPPDATA',
        'LOGONSERVER',
        'LOG_LEVEL',
        'MICROSOFT_WINDOWSAPPRUNTIME_BASE_DIRECTORY',
        'MIC_LD_LIBRARY_PATH',
        'NODE',
        'NODE_ENV',
        'NODE_PATH',
        'npm_command',
        'npm_config_cache',
        'npm_config_globalconfig',
        'npm_config_global_prefix',
        'npm_config_init_module',
        'npm_config_local_prefix',
        'npm_config_node_gyp',
        'npm_config_noproxy',
        'npm_config_npm_version',
        'npm_config_prefix',
        'npm_config_userconfig',
        'npm_config_user_agent',
        'npm_execpath',
        'npm_lifecycle_event',
        'npm_lifecycle_script',
        'npm_node_execpath',
        'npm_package_json',
        'npm_package_name',
        'npm_package_version',
        'NUMBER_OF_PROCESSORS',
        'NVM_HOME',
        'NVM_SYMLINK',
        'OneDrive',
        'OneDriveConsumer',
        'OS',
        'PAGER',
        'Path',
        'PATHEXT',
        'PNPM_HOME',
        'PORT',
        'POSH_INSTALLER',
        'POSH_THEMES_PATH',
        'POWERSHELL_DISTRIBUTION_CHANNEL',
        'PROCESSOR_ARCHITECTURE',
        'PROCESSOR_IDENTIFIER',
        'PROCESSOR_LEVEL',
        'PROCESSOR_REVISION',
        'ProgramData',
        'ProgramFiles',
        'ProgramFiles(x86)',
        'ProgramW6432',
        'PROMPT',
        'PSModulePath',
        'PUBLIC',
        'RUN_COGNITO_INTEGRATION_TESTS',
        'SystemDrive',
        'SystemRoot',
        'TEMP',
        'TERM_PROGRAM',
        'TERM_PROGRAM_VERSION',
        'TMP',
        'TS_JEST',
        'USERDOMAIN',
        'USERDOMAIN_ROAMINGPROFILE',
        'USERNAME',
        'USERPROFILE',
        'VSCODE_GIT_ASKPASS_EXTRA_ARGS',
        ... 8 more items
      ]

      at new EnvironmentConfigService (src/infrastructure/config/EnvironmentConfigService.ts:41:21)
          at Array.map (<anonymous>)

    console.info
      [ConfigService] Required configuration keys verified.

      at new EnvironmentConfigService (src/infrastructure/config/EnvironmentConfigService.ts:49:17)
          at Array.map (<anonymous>)

    console.info
      [WinstonLogger] Logger initialized with level "info" in "test" environment.

      at WinstonLogger.initializeLogger (src/infrastructure/logging/WinstonLogger.ts:68:17)
          at Array.map (<anonymous>)

    console.log
      {"level":"info","message":"CognitoUserMgmtAdapter initialized","metadata":{"region":"ap-south-1","userPoolId":"ap-south-1_7mqSevmEI"},"timestamp":"2026-02-23T14:26:59.706Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.warn
      Running Cognito integration tests against User Pool ID: ap-south-1_7mqSevmEI

      35 |                 throw new Error("Cognito adapter test running without TEST user pool ID configured. ABORTING.");
      36 |             }
    > 37 |             console.warn(`Running Cognito integration tests against User Pool ID: ${testPoolId}`);
         |                     ^
      38 |
      39 |             // Create shared resources
      40 |             const userDetails: AdminCreateUserDetails = {

      at tests/integration/Adapter/CognitoUserMgmtAdapter.integration.spec.ts:37:21
      at tests/integration/Adapter/CognitoUserMgmtAdapter.integration.spec.ts:8:71
      at Object.<anonymous>.__awaiter (tests/integration/Adapter/CognitoUserMgmtAdapter.integration.spec.ts:4:12)
      at Object.<anonymous> (tests/integration/Adapter/CognitoUserMgmtAdapter.integration.spec.ts:28:26)

    console.log
      {"level":"info","message":"Admin successfully created user: primary-user-1771856819646","metadata":{},"timestamp":"2026-02-23T14:27:00.413Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"info","message":"Admin successfully updated attributes for user: primary-user-1771856819646","metadata":{},"timestamp":"2026-02-23T14:27:00.621Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"info","message":"Admin successfully created group: primary-group-1771856819646","metadata":{},"timestamp":"2026-02-23T14:27:00.866Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"error","message":"CircuitBreaker (UnnamedService) failure detected.","metadata":{"error":{"message":"User account already exists","name":"UsernameExistsException","stack":"UsernameExistsException: User account already exists\n    at de_UsernameExistsExceptionRes (E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+client-cognito-identity-provider@3.879.0\\node_modules\\@aws-sdk\\client-cognito-identity-provider\\dist-cjs\\index.js:5124:21)\n    at de_CommandError (E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+client-cognito-identity-provider@3.879.0\\node_modules\\@aws-sdk\\client-cognito-identity-provider\\dist-cjs\\index.js:4616:19)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+middleware-serde@4.0.9\\node_modules\\@smithy\\middleware-serde\\dist-cjs\\index.js:36:20\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+core@3.9.0\\node_modules\\@smithy\\core\\dist-cjs\\index.js:193:18\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+middleware-retry@4.1.20\\node_modules\\@smithy\\middleware-retry\\dist-cjs\\index.js:320:38\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+middleware-logger@3.876.0\\node_modules\\@aws-sdk\\middleware-logger\\dist-cjs\\index.js:33:22"}},"timestamp":"2026-02-23T14:27:01.476Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"warn","message":"CircuitBreaker (UnnamedService) opened. Service failing.","metadata":{},"timestamp":"2026-02-23T14:27:01.482Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"error","message":"Cognito Admin error during adminCreateUser","metadata":{"error":{"errorMessage":"User account already exists","errorName":"UsernameExistsException","stack":"UsernameExistsException: User account already exists\n    at de_UsernameExistsExceptionRes (E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+client-cognito-identity-provider@3.879.0\\node_modules\\@aws-sdk\\client-cognito-identity-provider\\dist-cjs\\index.js:5124:21)\n    at de_CommandError (E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+client-cognito-identity-provider@3.879.0\\node_modules\\@aws-sdk\\client-cognito-identity-provider\\dist-cjs\\index.js:4616:19)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+middleware-serde@4.0.9\\node_modules\\@smithy\\middleware-serde\\dist-cjs\\index.js:36:20\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+core@3.9.0\\node_modules\\@smithy\\core\\dist-cjs\\index.js:193:18\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+middleware-retry@4.1.20\\node_modules\\@smithy\\middleware-retry\\dist-cjs\\index.js:320:38\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+middleware-logger@3.876.0\\node_modules\\@aws-sdk\\middleware-logger\\dist-cjs\\index.js:33:22"}},"timestamp":"2026-02-23T14:27:01.483Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)
          at Generator.throw (<anonymous>)

    console.log
      {"level":"error","message":"CircuitBreaker (UnnamedService) failure detected.","metadata":{"error":{"message":"User does not exist.","name":"UserNotFoundException","stack":"UserNotFoundException: User does not exist.\n    at de_UserNotFoundExceptionRes (E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+client-cognito-identity-provider@3.879.0\\node_modules\\@aws-sdk\\client-cognito-identity-provider\\dist-cjs\\index.js:5142:21)\n    at de_CommandError (E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+client-cognito-identity-provider@3.879.0\\node_modules\\@aws-sdk\\client-cognito-identity-provider\\dist-cjs\\index.js:4580:19)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+middleware-serde@4.0.9\\node_modules\\@smithy\\middleware-serde\\dist-cjs\\index.js:36:20\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+core@3.9.0\\node_modules\\@smithy\\core\\dist-cjs\\index.js:193:18\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+middleware-retry@4.1.20\\node_modules\\@smithy\\middleware-retry\\dist-cjs\\index.js:320:38\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+middleware-logger@3.876.0\\node_modules\\@aws-sdk\\middleware-logger\\dist-cjs\\index.js:33:22"}},"timestamp":"2026-02-23T14:27:01.602Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"warn","message":"CircuitBreaker (UnnamedService) opened. Service failing.","metadata":{},"timestamp":"2026-02-23T14:27:01.603Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"error","message":"CircuitBreaker (UnnamedService) failure detected.","metadata":{"error":{"message":"A group with the name already exists.","name":"GroupExistsException","stack":"GroupExistsException: A group with the name already exists.\n    at de_GroupExistsExceptionRes (E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+client-cognito-identity-provider@3.879.0\\node_modules\\@aws-sdk\\client-cognito-identity-provider\\dist-cjs\\index.js:4827:21)\n    at de_CommandError (E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+client-cognito-identity-provider@3.879.0\\node_modules\\@aws-sdk\\client-cognito-identity-provider\\dist-cjs\\index.js:4682:19)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+middleware-serde@4.0.9\\node_modules\\@smithy\\middleware-serde\\dist-cjs\\index.js:36:20\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+core@3.9.0\\node_modules\\@smithy\\core\\dist-cjs\\index.js:193:18\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+middleware-retry@4.1.20\\node_modules\\@smithy\\middleware-retry\\dist-cjs\\index.js:320:38\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+middleware-logger@3.876.0\\node_modules\\@aws-sdk\\middleware-logger\\dist-cjs\\index.js:33:22"}},"timestamp":"2026-02-23T14:27:01.982Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"warn","message":"CircuitBreaker (UnnamedService) opened. Service failing.","metadata":{},"timestamp":"2026-02-23T14:27:01.983Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"error","message":"Cognito Admin error during adminCreateGroup","metadata":{"error":{"errorMessage":"A group with the name already exists.","errorName":"GroupExistsException","stack":"GroupExistsException: A group with the name already exists.\n    at de_GroupExistsExceptionRes (E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+client-cognito-identity-provider@3.879.0\\node_modules\\@aws-sdk\\client-cognito-identity-provider\\dist-cjs\\index.js:4827:21)\n    at de_CommandError (E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+client-cognito-identity-provider@3.879.0\\node_modules\\@aws-sdk\\client-cognito-identity-provider\\dist-cjs\\index.js:4682:19)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+middleware-serde@4.0.9\\node_modules\\@smithy\\middleware-serde\\dist-cjs\\index.js:36:20\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+core@3.9.0\\node_modules\\@smithy\\core\\dist-cjs\\index.js:193:18\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@smithy+middleware-retry@4.1.20\\node_modules\\@smithy\\middleware-retry\\dist-cjs\\index.js:320:38\n    at E:\\NodeJS\\PBAC_Auth\\user-management-service\\node_modules\\.pnpm\\@aws-sdk+middleware-logger@3.876.0\\node_modules\\@aws-sdk\\middleware-logger\\dist-cjs\\index.js:33:22"}},"timestamp":"2026-02-23T14:27:01.983Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)
          at Generator.throw (<anonymous>)

    console.log
      {"level":"info","message":"Admin successfully added user primary-user-1771856819646 to group primary-group-1771856819646","metadata":{},"timestamp":"2026-02-23T14:27:02.195Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"info","message":"Admin successfully removed user primary-user-1771856819646 from group primary-group-1771856819646","metadata":{},"timestamp":"2026-02-23T14:27:02.510Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"info","message":"Admin successfully updated attributes for user: primary-user-1771856819646","metadata":{},"timestamp":"2026-02-23T14:27:02.842Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"info","message":"Admin successfully disabled user: primary-user-1771856819646","metadata":{},"timestamp":"2026-02-23T14:27:03.112Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"info","message":"Admin successfully enabled user: primary-user-1771856819646","metadata":{},"timestamp":"2026-02-23T14:27:03.349Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"info","message":"Admin successfully set password for user: primary-user-1771856819646","metadata":{},"timestamp":"2026-02-23T14:27:03.801Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"info","message":"Admin successfully added user primary-user-1771856819646 to group primary-group-1771856819646","metadata":{},"timestamp":"2026-02-23T14:27:04.285Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"info","message":"Admin successfully removed user primary-user-1771856819646 from group primary-group-1771856819646","metadata":{},"timestamp":"2026-02-23T14:27:04.523Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      Cleaning up all Cognito resources...

      at tests/integration/Adapter/CognitoUserMgmtAdapter.integration.spec.ts:61:17

    console.log
      {"level":"info","message":"Admin successfully removed user primary-user-1771856819646 from group primary-group-1771856819646","metadata":{},"timestamp":"2026-02-23T14:27:04.665Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"info","message":"Admin successfully deleted user: primary-user-1771856819646","metadata":{},"timestamp":"2026-02-23T14:27:04.888Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      Cleaned up user: primary-user-1771856819646

      at tests/integration/Adapter/CognitoUserMgmtAdapter.integration.spec.ts:78:25

    console.log
      {"level":"info","message":"Request to deactivate group: primary-group-1771856819646.","metadata":{},"timestamp":"2026-02-23T14:27:04.889Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      {"level":"info","message":"Admin successfully deactivated group: primary-group-1771856819646","metadata":{},"timestamp":"2026-02-23T14:27:05.103Z"}

      at Console.log (node_modules/.pnpm/winston@3.17.0/node_modules/winston/lib/winston/transports/console.js:87:23)

    console.log
      Cleaned up group: primary-group-1771856819646

      at tests/integration/Adapter/CognitoUserMgmtAdapter.integration.spec.ts:90:25


Test Suites: 2 failed, 1 passed, 3 total
Tests:       15 failed, 14 passed, 29 total
Snapshots:   0 total
Time:        20.446 s, estimated 38 s
Ran all test suites matching /tests\\e2e\\user.admin.e2e.spec.ts|tests\\integration\\Persistence\\DynamoUserProfileRepository.integration.spec.ts|tests\\integration\\Adapter\\CognitoUserMgmtAdapter.integration.spec.ts/i.
Table TestRoles not found.
Table TestPolicies not found.
Table TestAssignments not found.
Table TestUsers not found.
Table TestPermissions not found.
